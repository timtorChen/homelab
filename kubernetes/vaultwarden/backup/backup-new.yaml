---
# yaml-language-server: $schema=https://raw.githubusercontent.com/argoproj/argo-workflows/refs/heads/main/api/jsonschema/schema.json
apiVersion: argoproj.io/v1alpha1
kind: CronWorkflow
metadata:
  namespace: vaultwarden
  name: data-backup
spec:
  timezone: Asia/Taipei
  schedules:
    - "0 8 * * *"
  concurrencyPolicy: Forbid
  workflowSpec:
    serviceAccountName: vaultwarden-backup
    entrypoint: main
    arguments:
      parameters:
        - name: pvcName
          value: vaultwarden-data
        - name: volumeSnapshotClass
          value: rook-ceph-rbd
        - name: storageClassName
          value: rbd-fast-ec
        - name: cacheStorageClassName
          value: rbd-fast-ec
        - name: cacheSize
          value: 1Gi
    workflowTemplateRef:
      name: pvc-backup-to-s3-workflowtemplate
      clusterScope: true
